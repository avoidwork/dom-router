/*
 2014 Jason Mulligan
 @version 1.0.1
 */
!function(a,b){"use strict";function c(a,b){return a.indexOf(b)>-1}function d(a){this.hash=a.hash,this.element=a.element,this.trigger=a.trigger,this.timestamp=(new Date).toISOString()}function e(a){return new d(a)}function Router(){this.active=!0,this.callback=null,this.css=null,this.ctx=null,this["default"]=null,this.delimiter=null,this.history=[],this.log=!1,this.routes=[],this.select=null,this.stop=!0}function f(d){var e=new Router,f=a.location.hash.replace("#","");return b.addEventListener("hashchange",function(a){e.hashchange.call(e,a)},!1),e.active=void 0!==d.active?d.active===!0:!0,e.callback=d.callback||null,e.css=d.css||{current:"current",hidden:"hidden"},e.ctx=d.ctx&&"function"==typeof d.ctx.querySelectorAll?d.ctx:a.body,e.delimiter=d.delimiter||"/",e.log=void 0!==d.log?d.log===!0:!1,e.select=function(a){return[].slice.call(e.ctx.querySelectorAll.call(e.ctx,a))},e.stop=void 0!==d.stop?d.stop===!0:!0,e.scan(d["default"]),e.css.hidden in e.ctx.classList||(""!==f&&c(e.routes,f)?e.hashchange({oldURL:"",newURL:a.location.hash}):e.route(e["default"])),e}var g,h=/.*\#/,i=(new Date).getTime();g=b.requestAnimationFrame||function(a){var b=(new Date).getTime()-i;setTimeout(function(){a(b)},16)},Router.prototype.constructor=Router,Router.prototype.current=function(){return this.history[0]},Router.prototype.hashchange=function(a){var b=this,d=c(a.oldURL,"#")?a.oldURL.replace(h,""):null,f=c(a.newURL,"#")?a.newURL.replace(h,""):null;if(this.active){if(this.stop===!0&&"function"==typeof a.preventDefault&&(a.preventDefault(),a.stopPropagation()),!c(this.routes,f))return this.route(this.routes.filter(function(a){return c(a,f)})[0]||this["default"]);g(function(){var a,c,g,h=d?d.split(b.delimiter):[],i=f.split(b.delimiter);i.forEach(function(a,d){var e=d+1,f=h.length>=e,j=f?b.select("#"+h.slice(0,e).join(" > #"))[0]:null,k=f?b.select("a[href='#"+h.slice(0,e).join(b.delimiter)+"']")[0]:null;c=b.select("#"+i.slice(0,e).join(" > #"))[0],g=b.select("a[href='#"+i.slice(0,e).join(b.delimiter)+"']")[0],b.load(k||null,j||null,g||null,c||null)},this),b.css.current&&b.history.length>0&&b.history[0].trigger.classList.remove(b.css.current),a=e({element:c||null,hash:f,trigger:g||null}),b.log===!0&&b.history.unshift(a),null!==b.callback&&b.callback(a)})}},Router.prototype.load=function(a,b,c,d){return a&&this.css.current&&a.classList.remove(this.css.current),b&&b.id!==d.id&&b.classList.add(this.css.hidden),c&&this.css.current&&c.classList.add(this.css.current),d&&this.sweep(d,this.css.hidden),this},Router.prototype.route=function(b){return a.location.hash=b,this},Router.prototype.scan=function(a){return this.routes=this.select("a").filter(function(a){return c(a.href,"#")}).map(function(a){return a.href.replace(h,"")}),this["default"]=a||this.routes[0],this},Router.prototype.sweep=function(a,b){return[].slice.call(a.parentNode.childNodes).filter(function(b){return 1===b.nodeType&&b.id&&b.id!==a.id}).forEach(function(a){a.classList.add(b)},this),a.classList.remove(b),this},"undefined"!=typeof exports?module.exports=f:"function"==typeof define?define(function(){return f}):b.router=f}(document,window);
//# sourceMappingURL=dom-router.min.js.map