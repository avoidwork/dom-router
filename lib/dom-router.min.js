/*
 2018 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 3.0.2
*/
"use strict";(function(a,b){function c(a){const c=new k(a),d=(a)=>{c.active&&c.hashchange.call(c,a)};return"addEventListener"in b?b.addEventListener("hashchange",d,!1):b.onhashchange=d,c.process(),c}const d=/.*\#/,e="function"==typeof Array.includes?(a,b)=>a.includes(b):(a,b)=>-1<a.indexOf(b),f="function"==typeof Array.from?(a)=>Array.from(a):(a)=>[].slice.call(a),g=(c,a)=>c in a,h=new Date().getTime(),i=b.requestAnimationFrame||function(a){setTimeout(a(new Date().getTime()-h),16)};class j{constructor(a){this.hash=a.hash,this.element=a.element,this.trigger=a.trigger,this.timestamp=new Date().toISOString()}}class k{constructor({active:b=!0,callback:c=function(){},css:d={current:"dr-current",hidden:"dr-hidden"},ctx:e=a.body,start:f=null,delimiter:g="/",logging:h=!1,stop:i=!0}={}){this.active=b,this.callback=c,this.css=d,this.ctx=e,this.start=f,this.delimiter=g,this.history=[],this.logging=h,this.routes=[],this.stop=i}current(){return this.history[0]}hashchange(a){const b=this,c=e(a.oldURL,"#")?a.oldURL.replace(d,""):null,f=e(a.newURL,"#")?a.newURL.replace(d,""):null;this.active&&(!0===this.stop&&"function"==typeof a.stopPropagation&&(a.stopPropagation(),"function"==typeof a.preventDefault&&a.preventDefault()),e(this.routes,f)?i(()=>{let a,d,e=c?c.split(b.delimiter):[],g=f.split(b.delimiter);g.forEach((c,f)=>{let h=f+1,i=e.length>=h,j=i?b.select("#"+e.slice(0,h).join(" > #"))[0]:null,k=i?b.select("a[href='#"+e.slice(0,h).join(b.delimiter)+"']")[0]:null;a=b.select("#"+g.slice(0,h).join(" > #"))[0],d=b.select("a[href='#"+g.slice(0,h).join(b.delimiter)+"']")[0],b.load(k||null,j||null,d||null,a||null)},this),b.css.current&&0<b.history.length&&b.history[0].trigger.classList.remove(b.css.current);let h=new j({element:a||null,hash:f,trigger:d||null});b.log(h),b.callback(h)}):this.route(this.routes.filter((a)=>e(a,f))[0]||this.start))}load(a,b,c,d){return a&&this.css.current&&a.classList.remove(this.css.current),b&&b.id!==d.id&&b.classList.add(this.css.hidden),c&&this.css.current&&c.classList.add(this.css.current),d&&this.sweep(d,this.css.hidden),this}log(a){return this.logging&&this.history.unshift(a),this}process(){if(this.active){const b=a.location.hash.replace("#","");this.scan(this.start),g(this.css.hidden,this.ctx.classList)||(""!==b&&e(this.routes,b)?this.hashchange({oldURL:"",newURL:a.location.hash}):this.route(this.start))}}route(b=""){return a.location.hash=b,this}select(a){return f(this.ctx.querySelectorAll.call(this.ctx,a))}scan(a){return this.routes=this.select("a").filter((a)=>e(a.href,"#")).map((a)=>a.href.replace(d,"")).filter((a)=>""!==a),this.start=a||this.routes[0]||null,this}sweep(a,b){return f(a.parentNode.childNodes).filter((b)=>1===b.nodeType&&b.id&&b.id!==a.id).forEach((a)=>a.classList.add(b)),a.classList.remove(b),this}}c.version="3.0.2","undefined"==typeof exports?"function"==typeof define&&void 0!==define.amd?define(()=>c):b.router=c:module.exports=c})(document,window);
//# sourceMappingURL=dom-router.min.js.map