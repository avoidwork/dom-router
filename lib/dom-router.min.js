/*
 2018 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 3.0.4
*/
"use strict";(function(a,b){function c(a){const c=new k(a),d=(a)=>{c.active&&c.hashchange.call(c,a)};return"addEventListener"in b?b.addEventListener("hashchange",d,!1):b.onhashchange=d,c.process(),c}const d=/.*\#/,e="function"==typeof Array.includes?(a,b)=>a.includes(b):(a,b)=>-1<a.indexOf(b),f="function"==typeof Array.from?(a)=>Array.from(a):(a)=>[].slice.call(a),g=(c,a)=>c in a,h=new Date().getTime(),i=b.requestAnimationFrame||function(a){setTimeout(a(new Date().getTime()-h),16)};class j{constructor(a){this.hash=a.hash,this.element=a.element,this.trigger=a.trigger,this.timestamp=new Date().toISOString()}}class k{constructor({active:b=!0,callback:c=function(){},css:d={current:"dr-current",hidden:"dr-hidden"},ctx:e=a.body,start:f=null,delimiter:g="/",error:h=function(){},logging:i=!1,stop:j=!0}={}){this.active=b,this.callback=c,this.css=d,this.ctx=e,this.error=h,this.start=f,this.delimiter=g,this.history=[],this.logging=i,this.routes=[],this.stop=j}current(){return this.history[0]}hashchange(a){const b=e(a.oldURL,"#")?a.oldURL.replace(d,""):null,c=e(a.newURL,"#")?a.newURL.replace(d,""):null;this.active&&(!0===this.stop&&"function"==typeof a.stopPropagation&&(a.stopPropagation(),"function"==typeof a.preventDefault&&a.preventDefault()),e(this.routes,c)?i(()=>{try{const a=b?b.split(this.delimiter):[],d=c.split(this.delimiter);let e,f;d.forEach((b,c)=>{let g=c+1,h=a.length>=g,i=h?this.select("#"+a.slice(0,g).join(" > #"))[0]:null,j=h?this.select("a[href='#"+a.slice(0,g).join(this.delimiter)+"']")[0]:null;e=this.select("#"+d.slice(0,g).join(" > #"))[0],f=this.select("a[href='#"+d.slice(0,g).join(this.delimiter)+"']")[0],this.load(j||null,i||null,f||null,e||null)},this);const g=new j({element:e||null,hash:c,trigger:f||null});self.log(g),self.callback(g)}catch(a){this.error(a)}}):this.route(this.routes.filter((a)=>e(a,c))[0]||this.start))}load(a,b,c,d){return a&&this.css.current&&a.classList.remove(this.css.current),b&&b.id!==d.id&&b.classList.add(this.css.hidden),c&&this.css.current&&c.classList.add(this.css.current),d&&this.sweep(d,this.css.hidden),this}log(a){return this.logging&&this.history.unshift(a),this}process(){if(this.active){const b=a.location.hash.replace("#","");this.scan(this.start),g(this.css.hidden,this.ctx.classList)||(""!==b&&e(this.routes,b)?this.hashchange({oldURL:"",newURL:a.location.hash}):this.route(this.start))}}route(b=""){return a.location.hash=b,this}select(a){return f(this.ctx.querySelectorAll.call(this.ctx,a))}scan(a){return this.routes=this.select("a").filter((a)=>e(a.href,"#")).map((a)=>a.href.replace(d,"")).filter((a)=>""!==a),this.start=a||this.routes[0]||null,this}sweep(a,b){return f(a.parentNode.childNodes).filter((b)=>1===b.nodeType&&b.id&&b.id!==a.id).forEach((a)=>a.classList.add(b)),a.classList.remove(b),this}}c.version="3.0.4","undefined"==typeof exports?"function"==typeof define&&void 0!==define.amd?define(()=>c):b.router=c:module.exports=c})(document,window);
//# sourceMappingURL=dom-router.min.js.map