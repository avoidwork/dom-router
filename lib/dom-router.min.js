/**
 * URL hash DOM router
 *
 * @author Jason Mulligan <jason.mulligan@avoidwork.com>
 * @copyright 2021
 * @license BSD-3-Clause
 * @version 4.0.0
 */"use strict";(function(a,b){function c(a){const c=new k(a);return c.popstate=c.popstate.bind(c),"addEventListener"in b?b.addEventListener("popstate",c.popstate,!1):b.onpopstate=c.popstate,c.active&&c.process(),c}const d=/.*\#/,e="function"==typeof Array.includes?(a,b)=>a.includes(b):(a,b)=>-1<a.indexOf(b),f="function"==typeof Array.from?a=>Array.from(a):a=>[].slice.call(a),g=(c,a)=>c in a,h=new Date().getTime(),i=b.requestAnimationFrame||function(a){setTimeout(a(new Date().getTime()-h),16)};class j{constructor(a){this.hash=a.hash,this.element=a.element,this.trigger=a.trigger,this.timestamp=new Date().toISOString()}}class k{constructor({active:b=!0,callback:c=function(){},css:d={current:"dr-current",hidden:"dr-hidden"},ctx:e=a.body,start:f=null,delimiter:g="/",error:h=function(){},logging:i=!1,stop:j=!0}={}){this.active=b,this.callback=c,this.css=d,this.ctx=e,this.error=h,this.start=f,this.delimiter=g,this.history=[],this.logging=i,this.routes=[],this.stop=j}current(){return this.history[this.history.length-1]}handler(){const b=0<this.history.length?(this.current().hash||"").replace(d,"")||null:null,c=e(location.hash,"#")?location.hash.replace(d,""):null;if(this.active&&this.valid(c))if(!e(this.routes,c))this.route(this.routes.filter(a=>e(a,c))[0]||this.start);else{const d=a.body.scrollTop;i(()=>{try{const e=b?b.split(this.delimiter):[],f=c.split(this.delimiter);let g,h,i="";// deep links
for(const a of e)i+=`${0<i.length?`${this.delimiter}`:""}${a}`,this.select(`a[href="#${i}"]`).forEach(a=>a.classList.remove("is-active"));f.forEach((a,b)=>{const c=b+1,d=e.length>=c,i=d?this.select(`#${e.slice(0,c).join(" #")}`):void 0,j=d?this.select(`a[href='#${e.slice(0,c).join(this.delimiter)}']`):void 0;g=this.select(`#${f.slice(0,c).join(" #")}`),h=this.select(`a[href='#${f.slice(0,c).join(this.delimiter)}']`),this.load(j,i,h,g)},this);const k=new j({element:g,hash:c,trigger:h});a.body.scrollTop=d,this.log(k),this.callback(k)}catch(a){this.error(a)}})}}load(a=[],b=[],c=[],d=[]){return 0<this.css.current.length&&(0<a.length&&a.forEach(a=>a.classList.remove(this.css.current)),0<b.length&&b.id!==d.id&&b.forEach(a=>a.classList.add(this.css.hidden)),0<c.length&&c.forEach(a=>a.classList.add(this.css.current)),0<d.length&&d.forEach(a=>this.sweep(a,this.css.hidden))),this}log(a){return this.history.push(this.logging?a:{hash:a.hash}),this}popstate(a){this.handler(a)}process(){const b=a.location.hash.replace("#","");this.scan(this.start),g(this.css.hidden,this.ctx.classList)||(0<b.length&&e(this.routes,b)?this.handler():this.route(this.start))}route(b=""){return a.location.hash=b,this}select(a){return f(this.ctx.querySelectorAll.call(this.ctx,a))}scan(a){return this.routes=Array.from(new Set(this.select("a").filter(a=>e(a.href,"#")).map(a=>a.href.replace(d,"")).filter(a=>""!==a))),this.start=a||this.routes[0]||null,this}sweep(a,b){return f(a.parentNode.childNodes).filter(b=>1===b.nodeType&&b.id&&b.id!==a.id).forEach(a=>a.classList.add(b)),a.classList.remove(b),this}valid(a=""){return""===a||!1===/=/.test(a)}}c.version="4.0.0","undefined"==typeof exports?"function"==typeof define&&void 0!==define.amd?define(()=>c):b.router=c:module.exports=c})(document,window);
//# sourceMappingURL=dom-router.min.js.map