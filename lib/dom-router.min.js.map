{"version":3,"file":"dom-router.min.js","sources":["dom-router.js"],"names":["document","window","contains","obj","arg","indexOf","Route","this","hash","element","route","Router","active","callback","css","hidden","ctx","history","log","routes","select","stop","router","a","t","r","location","replace","addEventListener","hashchange","bind","undefined","querySelectorAll","body","slice","call","filter","i","href","map","not_hash","classList","remove","add","render","time","Date","getTime","requestAnimationFrame","fn","offset","setTimeout","prototype","constructor","current","ev","$oldEl","$newEl","$oldItem","$newItem","oldHash","oldURL","newHash","newURL","preventDefault","stopPropagation","parentNode","unshift","exports","module","define"],"mappings":"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","sourcesContent":["/**\n * URL hash to DOM router\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2014 Jason Mulligan\n * @license BSD-3 <https://raw.github.com/avoidwork/dom-router/master/LICENSE>\n * @link http://avoidwork.github.io/dom-router\n * @module dom-router\n * @version 1.0.0\n */\n( function ( document, window ) {\n\"use strict\";\n\nvar not_hash = /.*\\#/,\n\ttime = new Date().getTime(),\n\trender;\n\nrender = window.requestAnimationFrame || function ( fn ) {\n\tvar offset = new Date().getTime() - time;\n\n\tsetTimeout( function () {\n\t\tfn( offset );\n\t}, 16 );\n};\n\n/**\n * Determines if `arg` is in `obj`\n *\n * @method contains\n * @param  {Mixed} obj Object to inspect\n * @param  {Mixed} arg Value to find\n * @return {Boolean}   `true` if found\n */\nfunction contains ( obj, arg ) {\n\treturn obj.indexOf( arg ) > -1;\n}\n\n/**\n * Route\n *\n * @param {Object} arg Descriptor\n * @constructor\n */\nfunction Route ( arg ) {\n\tthis.hash = arg.hash;\n\tthis.element = arg.element;\n}\n\n/**\n * Route factory\n *\n * @method route\n * @param  {Object} arg Descriptor\n * @return {Object}     Route\n */\nfunction route ( arg ) {\n\treturn new Route( arg );\n}\n\n/**\n * URL hash to DOM router\n *\n * @constructor\n */\nfunction Router () {\n\tthis.active = true;\n\tthis.callback = null;\n\tthis.css = {active: \"active\", hidden: \"hidden\"};\n\tthis.ctx = null;\n\tthis[\"default\"] = null;\n\tthis.history = [];\n\tthis.log = false;\n\tthis.routes = [];\n\tthis.select = null;\n\tthis.stop = true;\n}\n\n/**\n * Setting constructor loop\n *\n * @type {Object}\n */\nRouter.prototype.constructor = Router;\n\n/**\n * Returns the current route descriptor\n *\n * @method current\n * @return {Object} Route descriptor\n */\nRouter.prototype.current = function () {\n\treturn this.history[0];\n};\n\n/**\n * Hash change handler\n *\n * @method hashchange\n * @param  {Object} Event\n * @return {Undefined} undefined\n */\nRouter.prototype.hashchange = function ( ev ) {\n\tvar oldHash = contains( ev.oldURL, \"#\" ) ? ev.oldURL.replace( not_hash, \"\" ) : null,\n\t\tnewHash = contains( ev.newURL, \"#\" ) ? ev.newURL.replace( not_hash, \"\" ) : null,\n\t\t$oldEl, $newEl, $oldItem, $newItem, r;\n\n\tif ( this.active && ( oldHash ? contains( this.routes, oldHash ) : true ) && ( newHash ? contains( this.routes, newHash ) : false ) ) {\n\t\t$oldEl = oldHash ? this.select( \"#\" + oldHash )[ 0 ] : null;\n\t\t$newEl = newHash ? this.select( \"#\" + newHash )[ 0 ] : null;\n\t\t$oldItem = oldHash ? this.select( \"a[href='#\" + oldHash + \"']\" )[ 0 ] : null;\n\t\t$newItem = newHash ? this.select( \"a[href='#\" + newHash + \"']\" )[ 0 ] : null;\n\t\tr = route( { element: $newEl, hash: newHash } );\n\n\t\tif ( this.stop === true ) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t}\n\n\t\trender( function () {\n\t\t\tif ( $oldItem && $oldEl ) {\n\t\t\t\t$oldItem.parentNode.classList.remove( this.css.active );\n\t\t\t\t$oldEl.classList.add( this.css.hidden );\n\t\t\t}\n\n\t\t\tif ( $newItem && $newEl ) {\n\t\t\t\t$newItem.parentNode.classList.add( this.css.active );\n\t\t\t\t$newEl.classList.remove( this.css.hidden );\n\t\t\t}\n\t\t\telse if ( this[ \"default\" ] ) {\n\t\t\t\tthis.route( this[\"default\"] );\n\t\t\t}\n\n\t\t\tif ( this.log === true ) {\n\t\t\t\tthis.history.unshift( r );\n\t\t\t}\n\n\t\t\tif ( this.callback !== null ) {\n\t\t\t\tthis.callback( r );\n\t\t\t}\n\t\t}.bind( this ) );\n\t}\n};\n\n/**\n * Sets the route\n *\n * @method route\n * @param  {String} arg Route to set\n * @return {Object}     Router\n */\nRouter.prototype.route = function ( arg ) {\n\tdocument.location.hash = arg;\n\treturn this;\n};\n\n/**\n * Router factory\n *\n * @param  {Object} arg Descriptor\n * @return {Object} Router\n */\nfunction router ( arg ) {\n\tvar r = new Router(),\n\t\thash = document.location.hash.replace( \"#\", \"\" ),\n\t\ta, t;\n\n\t// Adding hook\n\twindow.addEventListener( \"hashchange\", r.hashchange.bind( r ), false );\n\n\t// Setting properties\n\tr.active = arg.active !== undefined ? ( arg.active === true ) : true;\n\tr.callback = arg.callback || null;\n\tr.ctx = arg.ctx && typeof arg.ctx.querySelectorAll == \"function\" ? arg.ctx : document.body;\n\tr.log = arg.log !== undefined ? ( arg.log === true ) : false;\n\tr.select = r.ctx.querySelectorAll.bind( r.ctx );\n\tr.stop = arg.stop !== undefined ? ( arg.stop === true ) : true;\n\n\tif ( arg.css ) {\n\t\tr.css = { active: \"active\", hidden: \"hidden\" };\n\t}\n\n\tr.routes = [].slice.call( r.select( \"a\" ) ).filter( function ( i ) {\n\t\treturn contains( i.href, \"#\" );\n\t} ).map( function ( i ) {\n\t\treturn i.href.replace( not_hash, \"\" );\n\t} );\n\n\tr[\"default\"] = arg[\"default\"] || r.routes[0];\n\n\t// Setting state\n\tif ( !( r.css.hidden in r.ctx.classList ) ) {\n\t\tif ( hash !== \"\" && contains( r.routes, hash ) ) {\n\t\t\tt = r.select( \"#\" + hash )[0];\n\t\t\tif ( t ) {\n\t\t\t\tt.classList.remove( r.css.hidden );\n\t\t\t}\n\n\t\t\tif ( r.css.active ) {\n\t\t\t\ta = r.select( \"a[href='#\" + hash + \"']\" )[ 0 ];\n\t\t\t\tif ( a ) {\n\t\t\t\t\ta.classList.add( r.css.active );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tr.route( r[\"default\"] );\n\t\t}\n\t}\n\n\treturn r;\n}\n\n// CJS, AMD & window supported\nif ( typeof exports != \"undefined\" ) {\n\tmodule.exports = router;\n}\nelse if ( typeof define == \"function\" ) {\n\tdefine( function () {\n\t\treturn router;\n\t} );\n}\nelse {\n\twindow.router = router;\n}\n} )( document, window );\n"]}