{"version":3,"sources":["dom-router.js"],"names":["document","window","factory","arg","obj","Router","hashchange","bind","addEventListener","onhashchange","active","process","not_hash","includes","Array","indexOf","from","slice","call","has","a","b","time","Date","getTime","render","requestAnimationFrame","fn","setTimeout","Route","constructor","cfg","hash","element","trigger","timestamp","toISOString","callback","css","current","hidden","ctx","body","start","delimiter","error","logging","stop","history","routes","ev","oldHash","oldURL","replace","newHash","newURL","valid","stopPropagation","preventDefault","oldHashes","split","newHashes","newEl","newTrigger","forEach","i","idx","nth","length","oldEl","select","join","oldTrigger","load","r","log","err","route","filter","classList","remove","id","add","sweep","unshift","location","scan","querySelectorAll","href","map","klass","parentNode","childNodes","nodeType","test","version","exports","define","amd","router","module"],"mappings":"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","file":"unknown","sourcesContent":["/**\r\n * URL hash DOM router\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2019\r\n * @license BSD-3-Clause\r\n * @version 3.1.0\r\n */\r\n(function (document, window) {\r\n\tconst not_hash = /.*\\#/,\r\n\t\tincludes = typeof Array.includes === \"function\" ? (obj, arg) => obj.includes(arg) : (obj, arg) => obj.indexOf(arg) > -1,\r\n\t\tfrom = typeof Array.from === \"function\" ? arg => Array.from(arg) : arg => [].slice.call(arg),\r\n\t\thas = (a, b) => a in b,\r\n\t\ttime = new Date().getTime(),\r\n\t\trender = window.requestAnimationFrame || function (fn) { setTimeout(fn(new Date().getTime() - time), 16); };\r\n\r\n\tclass Route {\r\n\t\tconstructor (cfg) {\r\n\t\t\tthis.hash = cfg.hash;\r\n\t\t\tthis.element = cfg.element;\r\n\t\t\tthis.trigger = cfg.trigger;\r\n\t\t\tthis.timestamp = new Date().toISOString();\r\n\t\t}\r\n\t}\r\n\r\n\tclass Router {\r\n\t\tconstructor ({active = true, callback = function () {}, css = {current: \"dr-current\", hidden: \"dr-hidden\"}, ctx = document.body, start = null, delimiter = \"/\", error = function () {}, logging = false, stop = true} = {}) {\r\n\t\t\tthis.active = active;\r\n\t\t\tthis.callback = callback;\r\n\t\t\tthis.css = css;\r\n\t\t\tthis.ctx = ctx;\r\n\t\t\tthis.error = error;\r\n\t\t\tthis.start = start;\r\n\t\t\tthis.delimiter = delimiter;\r\n\t\t\tthis.history = [];\r\n\t\t\tthis.logging = logging;\r\n\t\t\tthis.routes = [];\r\n\t\t\tthis.stop = stop;\r\n\t\t}\r\n\r\n\t\tcurrent () {\r\n\t\t\treturn this.history[0];\r\n\t\t}\r\n\r\n\t\thashchange (ev) {\r\n\t\t\tconst oldHash = includes(ev.oldURL, \"#\") ? ev.oldURL.replace(not_hash, \"\") : null,\r\n\t\t\t\tnewHash = includes(ev.newURL, \"#\") ? ev.newURL.replace(not_hash, \"\") : null;\r\n\r\n\t\t\tif (this.active && this.valid(newHash)) {\r\n\t\t\t\tif (this.stop === true && typeof ev.stopPropagation === \"function\") {\r\n\t\t\t\t\tev.stopPropagation();\r\n\r\n\t\t\t\t\tif (typeof ev.preventDefault === \"function\") {\r\n\t\t\t\t\t\tev.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!includes(this.routes, newHash)) {\r\n\t\t\t\t\tthis.route(this.routes.filter(i => includes(i, newHash))[0] || this.start);\r\n\t\t\t\t} else {\r\n\t\t\t\t\trender(() => {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconst oldHashes = oldHash ? oldHash.split(this.delimiter) : [],\r\n\t\t\t\t\t\t\t\tnewHashes = newHash.split(this.delimiter);\r\n\t\t\t\t\t\t\tlet newEl, newTrigger;\r\n\r\n\t\t\t\t\t\t\tnewHashes.forEach((i, idx) => {\r\n\t\t\t\t\t\t\t\tlet nth = idx + 1,\r\n\t\t\t\t\t\t\t\t\tvalid = oldHashes.length >= nth,\r\n\t\t\t\t\t\t\t\t\toldEl = valid ? this.select(\"#\" + oldHashes.slice(0, nth).join(\" #\"))[0] : null,\r\n\t\t\t\t\t\t\t\t\toldTrigger = valid ? this.select(\"a[href='#\" + oldHashes.slice(0, nth).join(this.delimiter) + \"']\")[0] : null;\r\n\r\n\t\t\t\t\t\t\t\tnewEl = this.select(\"#\" + newHashes.slice(0, nth).join(\" #\"))[0];\r\n\t\t\t\t\t\t\t\tnewTrigger = this.select(\"a[href='#\" + newHashes.slice(0, nth).join(this.delimiter) + \"']\")[0];\r\n\t\t\t\t\t\t\t\tthis.load(oldTrigger || null, oldEl || null, newTrigger || null, newEl || null);\r\n\t\t\t\t\t\t\t}, this);\r\n\r\n\t\t\t\t\t\t\tconst r = new Route({\r\n\t\t\t\t\t\t\t\telement: newEl || null,\r\n\t\t\t\t\t\t\t\thash: newHash,\r\n\t\t\t\t\t\t\t\ttrigger: newTrigger || null\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tthis.log(r);\r\n\t\t\t\t\t\t\tthis.callback(r);\r\n\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\tthis.error(err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tload (oldTrigger, oldEl, newTrigger, newEl) {\r\n\t\t\tif (oldTrigger && this.css.current) {\r\n\t\t\t\toldTrigger.classList.remove(this.css.current);\r\n\t\t\t}\r\n\r\n\t\t\tif (oldEl && oldEl.id !== newEl.id) {\r\n\t\t\t\toldEl.classList.add(this.css.hidden);\r\n\t\t\t}\r\n\r\n\t\t\tif (newTrigger && this.css.current) {\r\n\t\t\t\tnewTrigger.classList.add(this.css.current);\r\n\t\t\t}\r\n\r\n\t\t\tif (newEl) {\r\n\t\t\t\tthis.sweep(newEl, this.css.hidden);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tlog (arg) {\r\n\t\t\tif (this.logging) {\r\n\t\t\t\tthis.history.unshift(arg);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tprocess () {\r\n\t\t\tconst hash = document.location.hash.replace(\"#\", \"\");\r\n\r\n\t\t\tthis.scan(this.start);\r\n\r\n\t\t\tif (!has(this.css.hidden, this.ctx.classList)) {\r\n\t\t\t\tif (hash !== \"\" && includes(this.routes, hash)) {\r\n\t\t\t\t\tthis.hashchange({oldURL: \"\", newURL: document.location.hash});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.route(this.start);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\troute (arg = \"\") {\r\n\t\t\tdocument.location.hash = arg;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tselect (arg) {\r\n\t\t\treturn from(this.ctx.querySelectorAll.call(this.ctx, arg));\r\n\t\t}\r\n\r\n\t\tscan (arg) {\r\n\t\t\tthis.routes = this.select(\"a\").filter(i => includes(i.href, \"#\")).map(i => i.href.replace(not_hash, \"\")).filter(i => i !== \"\");\r\n\t\t\tthis.start = arg || this.routes[0] || null;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tsweep (obj, klass) {\r\n\t\t\tfrom(obj.parentNode.childNodes).filter(i => i.nodeType === 1 && i.id && i.id !== obj.id).forEach(i => i.classList.add(klass));\r\n\t\t\tobj.classList.remove(klass);\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvalid (arg = \"\") {\r\n\t\t\treturn arg === \"\" || (/=/).test(arg) === false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction factory (arg) {\r\n\t\tconst obj = new Router(arg);\r\n\r\n\t\tobj.hashchange = obj.hashchange.bind(obj);\r\n\r\n\t\tif (\"addEventListener\" in window) {\r\n\t\t\twindow.addEventListener(\"hashchange\", obj.hashchange, false);\r\n\t\t} else {\r\n\t\t\twindow.onhashchange = obj.hashchange;\r\n\t\t}\r\n\r\n\t\tif (obj.active) {\r\n\t\t\tobj.process();\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tfactory.version = \"3.1.0\";\r\n\r\n\t// CJS, AMD & window supported\r\n\tif (typeof exports !== \"undefined\") {\r\n\t\tmodule.exports = factory;\r\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\r\n\t\tdefine(() => factory);\r\n\t} else {\r\n\t\twindow.router = factory;\r\n\t}\r\n}(document, window));\r\n"]}