{"version":3,"file":"dom-router.min.js","sources":["dom-router.js"],"names":["_prototypeProperties","child","staticProps","instanceProps","Object","defineProperties","prototype","Array","from","arg","slice","call","document","window","not_hash","time","Date","getTime","contains","obj","indexOf","render","requestAnimationFrame","fn","offset","setTimeout","Route","options","this","hash","element","trigger","timestamp","toISOString","route","Router","active","callback","css","current","hidden","ctx","body","delimiter","history","logging","routes","stop","value","writable","enumerable","configurable","hashchange","ev","_this","self","oldHash","oldURL","replace","newHash","newURL","preventDefault","stopPropagation","filter","i","oldHashes","split","newHashes","newEl","undefined","newTrigger","forEach","idx","nth","valid","length","oldEl","select","join","oldTrigger","load","classList","remove","r","log","id","add","sweep","unshift","location","querySelectorAll","scan","href","map","klass","parentNode","childNodes","nodeType","router","facade","addEventListener","onhashchange","exports","module","define"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _prototypeProperties = function (child, staticProps, instanceProps) {\n  if (staticProps) Object.defineProperties(child, staticProps);\n  if (instanceProps) Object.defineProperties(child.prototype, instanceProps);\n};\n\n/**\n * URL hash to DOM router\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2015 Jason Mulligan\n * @license BSD-3 <https://raw.github.com/avoidwork/dom-router/master/LICENSE>\n * @link http://avoidwork.github.io/dom-router\n * @module dom-router\n * @version 1.1.1\n */\nArray.from = Array.from || function (arg) {\n  return [].slice.call(arg);\n};\n\n(function (document, window) {\n  var not_hash = /.*\\#/;\n  var time = new Date().getTime();\n\n  var contains = function (obj, arg) {\n    return obj.indexOf(arg) > -1;\n  };\n\n  var render = window.requestAnimationFrame || function (fn) {\n    var offset = new Date().getTime() - time;\n\n    setTimeout(function () {\n      fn(offset);\n    }, 16);\n  };\n\n  var Route = function Route(options) {\n    this.hash = options.hash;\n    this.element = options.element;\n    this.trigger = options.trigger;\n    this.timestamp = new Date().toISOString();\n  };\n\n  var route = function (arg) {\n    return new Route(arg);\n  };\n\n  var Router = (function () {\n    function Router() {\n      this.active = true;\n      this.callback = function () {};\n      this.css = { current: \"current\", hidden: \"hidden\" };\n      this.ctx = document.body;\n      this[\"default\"] = null;\n      this.delimiter = \"/\";\n      this.history = [];\n      this.logging = false;\n      this.routes = [];\n      this.stop = true;\n    }\n\n    _prototypeProperties(Router, null, {\n      current: {\n        value: function current() {\n          return this.history[0];\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      },\n      hashchange: {\n        value: function hashchange(ev) {\n          var _this = this;\n          var self = this;\n          var oldHash = contains(ev.oldURL, \"#\") ? ev.oldURL.replace(not_hash, \"\") : null;\n          var newHash = contains(ev.newURL, \"#\") ? ev.newURL.replace(not_hash, \"\") : null;\n\n          if (this.active) {\n            if (this.stop === true && typeof ev.preventDefault == \"function\") {\n              ev.preventDefault();\n              ev.stopPropagation();\n            }\n\n            if (!contains(this.routes, newHash)) {\n              return this.route(this.routes.filter(function (i) {\n                return contains(i, newHash);\n              })[0] || this[\"default\"]);\n            }\n\n            render(function () {\n              var oldHashes = oldHash ? oldHash.split(self.delimiter) : [];\n              var newHashes = newHash.split(self.delimiter);\n              var newEl = undefined,\n                  newTrigger = undefined;\n\n              newHashes.forEach(function (i, idx) {\n                var nth = idx + 1;\n                var valid = oldHashes.length >= nth;\n                var oldEl = valid ? self.select(\"#\" + oldHashes.slice(0, nth).join(\" > #\"))[0] : null;\n                var oldTrigger = valid ? self.select(\"a[href='#\" + oldHashes.slice(0, nth).join(self.delimiter) + \"']\")[0] : null;\n\n                newEl = self.select(\"#\" + newHashes.slice(0, nth).join(\" > #\"))[0];\n                newTrigger = self.select(\"a[href='#\" + newHashes.slice(0, nth).join(self.delimiter) + \"']\")[0];\n\n                self.load(oldTrigger || null, oldEl || null, newTrigger || null, newEl || null);\n              }, _this);\n\n              if (self.css.current && self.history.length > 0) {\n                self.history[0].trigger.classList.remove(self.css.current);\n              }\n\n              var r = route({ element: newEl || null, hash: newHash, trigger: newTrigger || null });\n              self.log(r);\n              self.callback(r);\n            });\n          }\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      },\n      load: {\n        value: function load(oldTrigger, oldEl, newTrigger, newEl) {\n          if (oldTrigger && this.css.current) {\n            oldTrigger.classList.remove(this.css.current);\n          }\n\n          if (oldEl && oldEl.id !== newEl.id) {\n            oldEl.classList.add(this.css.hidden);\n          }\n\n          if (newTrigger && this.css.current) {\n            newTrigger.classList.add(this.css.current);\n          }\n\n          if (newEl) {\n            this.sweep(newEl, this.css.hidden);\n          }\n\n          return this;\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      },\n      log: {\n        value: function log(arg) {\n          if (this.logging) {\n            this.history.unshift(arg);\n          }\n\n          return this;\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      },\n      route: {\n        value: function route(arg) {\n          document.location.hash = arg;\n          return this;\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      },\n      select: {\n        value: function select(arg) {\n          return Array.from(this.ctx.querySelectorAll.call(this.ctx, arg));\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      },\n      scan: {\n        value: function scan(arg) {\n          this.routes = this.select(\"a\").filter(function (i) {\n            return contains(i.href, \"#\");\n          }).map(function (i) {\n            return i.href.replace(not_hash, \"\");\n          });\n\n          this[\"default\"] = arg || this.routes[0];\n          return this;\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      },\n      sweep: {\n        value: function sweep(obj, klass) {\n          Array.from(obj.parentNode.childNodes).filter(function (i) {\n            return i.nodeType === 1 && i.id && i.id !== obj.id;\n          }).forEach(function (i) {\n            i.classList.add(klass);\n          }, this);\n\n          obj.classList.remove(klass);\n          return this;\n        },\n        writable: true,\n        enumerable: true,\n        configurable: true\n      }\n    });\n\n    return Router;\n  })();\n\n  var router = function (arg) {\n    var r = new Router();\n    var hash = document.location.hash.replace(\"#\", \"\");\n\n    var facade = function (ev) {\n      r.hashchange.call(r, ev);\n    };\n\n    if (\"addEventListener\" in window) {\n      window.addEventListener(\"hashchange\", facade, false);\n    } else {\n      window.onhashchange = facade;\n    }\n\n    if (arg instanceof Object) {\n      r.active = arg.active !== undefined ? arg.active === true : r.active;\n      r.callback = arg.callback || r.callback;\n      r.css = arg.css || r.css;\n      r.ctx = arg.ctx && typeof arg.ctx.querySelectorAll == \"function\" ? arg.ctx : r.ctx;\n      r.delimiter = arg.delimiter || r.delimiter;\n      r.logging = arg.logging !== undefined ? arg.logging === true : r.logging;\n      r.stop = arg.stop !== undefined ? arg.stop === true : r.stop;\n    }\n\n    r.scan(r[\"default\"]);\n\n    if (!(r.css.hidden in r.ctx.classList)) {\n      if (hash !== \"\" && contains(r.routes, hash)) {\n        r.hashchange({ oldURL: \"\", newURL: document.location.hash });\n      } else {\n        r.route(r[\"default\"]);\n      }\n    }\n\n    return r;\n  };\n\n  // CJS, AMD & window supported\n  if (typeof exports != \"undefined\") {\n    module.exports = router;\n  } else if (typeof define == \"function\") {\n    define(function () {\n      return router;\n    });\n  } else {\n    window.router = router;\n  }\n})(document, window);"]}