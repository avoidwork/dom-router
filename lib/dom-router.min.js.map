{"version":3,"sources":["dom-router.js"],"names":["active","hashchange","call","addEventListener","onhashchange","process","Array","includes","indexOf","from","slice","Date","getTime","requestAnimationFrame","setTimeout","constructor","hash","element","trigger","timestamp","toISOString","callback","css","current","hidden","ctx","body","start","delimiter","logging","stop","history","routes","oldURL","replace","newURL","stopPropagation","preventDefault","split","forEach","length","select","join","load","classList","remove","log","route","filter","id","add","sweep","unshift","location","scan","querySelectorAll","href","map","parentNode","childNodes","nodeType","version","exports","define","amd","router","module","document","window"],"mappings":"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","file":"unknown","sourcesContent":["/**\n * URL hash DOM router\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2018\n * @license BSD-3-Clause\n * @version 3.0.2\n */\n(function (document, window) {\n\tconst not_hash = /.*\\#/,\n\t\tincludes = typeof Array.includes === \"function\" ? (obj, arg) => obj.includes(arg) : (obj, arg) => obj.indexOf(arg) > -1,\n\t\tfrom = typeof Array.from === \"function\" ? arg => Array.from(arg) : arg => [].slice.call(arg),\n\t\thas = (a, b) => a in b,\n\t\ttime = new Date().getTime(),\n\t\trender = window.requestAnimationFrame || function (fn) { setTimeout(fn(new Date().getTime() - time), 16); };\n\n\tclass Route {\n\t\tconstructor (cfg) {\n\t\t\tthis.hash = cfg.hash;\n\t\t\tthis.element = cfg.element;\n\t\t\tthis.trigger = cfg.trigger;\n\t\t\tthis.timestamp = new Date().toISOString();\n\t\t}\n\t}\n\n\tclass Router {\n\t\tconstructor ({active = true, callback = function () {}, css = {current: \"dr-current\", hidden: \"dr-hidden\"}, ctx = document.body, start = null, delimiter = \"/\", logging = false, stop = true} = {}) {\n\t\t\tthis.active = active;\n\t\t\tthis.callback = callback;\n\t\t\tthis.css = css;\n\t\t\tthis.ctx = ctx;\n\t\t\tthis.start = start;\n\t\t\tthis.delimiter = delimiter;\n\t\t\tthis.history = [];\n\t\t\tthis.logging = logging;\n\t\t\tthis.routes = [];\n\t\t\tthis.stop = stop;\n\t\t}\n\n\t\tcurrent () {\n\t\t\treturn this.history[0];\n\t\t}\n\n\t\thashchange (ev) {\n\t\t\tconst self = this,\n\t\t\t\toldHash = includes(ev.oldURL, \"#\") ? ev.oldURL.replace(not_hash, \"\") : null,\n\t\t\t\tnewHash = includes(ev.newURL, \"#\") ? ev.newURL.replace(not_hash, \"\") : null;\n\n\t\t\tif (this.active) {\n\t\t\t\tif (this.stop === true && typeof ev.stopPropagation === \"function\") {\n\t\t\t\t\tev.stopPropagation();\n\n\t\t\t\t\tif (typeof ev.preventDefault === \"function\") {\n\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!includes(this.routes, newHash)) {\n\t\t\t\t\tthis.route(this.routes.filter(i => includes(i, newHash))[0] || this.start);\n\t\t\t\t} else {\n\t\t\t\t\trender(() => {\n\t\t\t\t\t\tlet oldHashes = oldHash ? oldHash.split(self.delimiter) : [];\n\t\t\t\t\t\tlet newHashes = newHash.split(self.delimiter);\n\t\t\t\t\t\tlet newEl, newTrigger;\n\n\t\t\t\t\t\tnewHashes.forEach((i, idx) => {\n\t\t\t\t\t\t\tlet nth = idx + 1;\n\t\t\t\t\t\t\tlet valid = oldHashes.length >= nth;\n\t\t\t\t\t\t\tlet oldEl = valid ? self.select(\"#\" + oldHashes.slice(0, nth).join(\" > #\"))[0] : null;\n\t\t\t\t\t\t\tlet oldTrigger = valid ? self.select(\"a[href='#\" + oldHashes.slice(0, nth).join(self.delimiter) + \"']\")[0] : null;\n\n\t\t\t\t\t\t\tnewEl = self.select(\"#\" + newHashes.slice(0, nth).join(\" > #\"))[0];\n\t\t\t\t\t\t\tnewTrigger = self.select(\"a[href='#\" + newHashes.slice(0, nth).join(self.delimiter) + \"']\")[0];\n\n\t\t\t\t\t\t\tself.load(oldTrigger || null, oldEl || null, newTrigger || null, newEl || null);\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\t\tif (self.css.current && self.history.length > 0) {\n\t\t\t\t\t\t\tself.history[0].trigger.classList.remove(self.css.current);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet r = new Route({element: newEl || null, hash: newHash, trigger: newTrigger || null});\n\n\t\t\t\t\t\tself.log(r);\n\t\t\t\t\t\tself.callback(r);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tload (oldTrigger, oldEl, newTrigger, newEl) {\n\t\t\tif (oldTrigger && this.css.current) {\n\t\t\t\toldTrigger.classList.remove(this.css.current);\n\t\t\t}\n\n\t\t\tif (oldEl && oldEl.id !== newEl.id) {\n\t\t\t\toldEl.classList.add(this.css.hidden);\n\t\t\t}\n\n\t\t\tif (newTrigger && this.css.current) {\n\t\t\t\tnewTrigger.classList.add(this.css.current);\n\t\t\t}\n\n\t\t\tif (newEl) {\n\t\t\t\tthis.sweep(newEl, this.css.hidden);\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlog (arg) {\n\t\t\tif (this.logging) {\n\t\t\t\tthis.history.unshift(arg);\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\n\t\tprocess () {\n\t\t\tif (this.active) {\n\t\t\t\tconst hash = document.location.hash.replace(\"#\", \"\");\n\n\t\t\t\tthis.scan(this.start);\n\n\t\t\t\tif (!has(this.css.hidden, this.ctx.classList)) {\n\t\t\t\t\tif (hash !== \"\" && includes(this.routes, hash)) {\n\t\t\t\t\t\tthis.hashchange({oldURL: \"\", newURL: document.location.hash});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.route(this.start);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\troute (arg = \"\") {\n\t\t\tdocument.location.hash = arg;\n\n\t\t\treturn this;\n\t\t}\n\n\t\tselect (arg) {\n\t\t\treturn from(this.ctx.querySelectorAll.call(this.ctx, arg));\n\t\t}\n\n\t\tscan (arg) {\n\t\t\tthis.routes = this.select(\"a\").filter(i => includes(i.href, \"#\")).map(i => i.href.replace(not_hash, \"\")).filter(i => i !== \"\");\n\t\t\tthis.start = arg || this.routes[0] || null;\n\n\t\t\treturn this;\n\t\t}\n\n\t\tsweep (obj, klass) {\n\t\t\tfrom(obj.parentNode.childNodes).filter(i => i.nodeType === 1 && i.id && i.id !== obj.id).forEach(i => i.classList.add(klass));\n\t\t\tobj.classList.remove(klass);\n\n\t\t\treturn this;\n\t\t}\n\t}\n\n\tfunction factory (arg) {\n\t\tconst obj = new Router(arg),\n\t\t\tfacade = ev => {\n\t\t\t\tif (obj.active) {\n\t\t\t\t\tobj.hashchange.call(obj, ev);\n\t\t\t\t}\n\t\t\t};\n\n\t\tif (\"addEventListener\" in window) {\n\t\t\twindow.addEventListener(\"hashchange\", facade, false);\n\t\t} else {\n\t\t\twindow.onhashchange = facade;\n\t\t}\n\n\t\tobj.process();\n\n\t\treturn obj;\n\t}\n\n\tfactory.version = \"3.0.2\";\n\n\t// CJS, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\n\t\tdefine(() => factory);\n\t} else {\n\t\twindow.router = factory;\n\t}\n}(document, window));\n"]}