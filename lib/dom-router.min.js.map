{"version":3,"sources":["dom-router.js"],"names":["hashchange","call","addEventListener","onhashchange","active","process","Array","includes","indexOf","from","slice","Date","getTime","requestAnimationFrame","setTimeout","constructor","hash","element","trigger","timestamp","toISOString","callback","css","current","hidden","ctx","body","start","delimiter","error","logging","stop","history","routes","oldURL","replace","newURL","valid","stopPropagation","preventDefault","split","forEach","length","select","join","load","log","route","filter","classList","remove","id","add","sweep","unshift","location","scan","querySelectorAll","href","map","parentNode","childNodes","nodeType","test","version","exports","define","amd","router","module","document","window"],"mappings":"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","file":"unknown","sourcesContent":["/**\r\n * URL hash DOM router\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2018\r\n * @license BSD-3-Clause\r\n * @version 3.0.7\r\n */\r\n(function (document, window) {\r\n\tconst not_hash = /.*\\#/,\r\n\t\tincludes = typeof Array.includes === \"function\" ? (obj, arg) => obj.includes(arg) : (obj, arg) => obj.indexOf(arg) > -1,\r\n\t\tfrom = typeof Array.from === \"function\" ? arg => Array.from(arg) : arg => [].slice.call(arg),\r\n\t\thas = (a, b) => a in b,\r\n\t\ttime = new Date().getTime(),\r\n\t\trender = window.requestAnimationFrame || function (fn) { setTimeout(fn(new Date().getTime() - time), 16); };\r\n\r\n\tclass Route {\r\n\t\tconstructor (cfg) {\r\n\t\t\tthis.hash = cfg.hash;\r\n\t\t\tthis.element = cfg.element;\r\n\t\t\tthis.trigger = cfg.trigger;\r\n\t\t\tthis.timestamp = new Date().toISOString();\r\n\t\t}\r\n\t}\r\n\r\n\tclass Router {\r\n\t\tconstructor ({active = true, callback = function () {}, css = {current: \"dr-current\", hidden: \"dr-hidden\"}, ctx = document.body, start = null, delimiter = \"/\", error = function () {}, logging = false, stop = true} = {}) {\r\n\t\t\tthis.active = active;\r\n\t\t\tthis.callback = callback;\r\n\t\t\tthis.css = css;\r\n\t\t\tthis.ctx = ctx;\r\n\t\t\tthis.error = error;\r\n\t\t\tthis.start = start;\r\n\t\t\tthis.delimiter = delimiter;\r\n\t\t\tthis.history = [];\r\n\t\t\tthis.logging = logging;\r\n\t\t\tthis.routes = [];\r\n\t\t\tthis.stop = stop;\r\n\t\t}\r\n\r\n\t\tcurrent () {\r\n\t\t\treturn this.history[0];\r\n\t\t}\r\n\r\n\t\thashchange (ev) {\r\n\t\t\tconst oldHash = includes(ev.oldURL, \"#\") ? ev.oldURL.replace(not_hash, \"\") : null,\r\n\t\t\t\tnewHash = includes(ev.newURL, \"#\") ? ev.newURL.replace(not_hash, \"\") : null;\r\n\r\n\t\t\tif (this.active && this.valid(newHash)) {\r\n\t\t\t\tif (this.stop === true && typeof ev.stopPropagation === \"function\") {\r\n\t\t\t\t\tev.stopPropagation();\r\n\r\n\t\t\t\t\tif (typeof ev.preventDefault === \"function\") {\r\n\t\t\t\t\t\tev.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!includes(this.routes, newHash)) {\r\n\t\t\t\t\tthis.route(this.routes.filter(i => includes(i, newHash))[0] || this.start);\r\n\t\t\t\t} else {\r\n\t\t\t\t\trender(() => {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconst oldHashes = oldHash ? oldHash.split(this.delimiter) : [],\r\n\t\t\t\t\t\t\t\tnewHashes = newHash.split(this.delimiter);\r\n\t\t\t\t\t\t\tlet newEl, newTrigger;\r\n\r\n\t\t\t\t\t\t\tnewHashes.forEach((i, idx) => {\r\n\t\t\t\t\t\t\t\tlet nth = idx + 1,\r\n\t\t\t\t\t\t\t\t\tvalid = oldHashes.length >= nth,\r\n\t\t\t\t\t\t\t\t\toldEl = valid ? this.select(\"#\" + oldHashes.slice(0, nth).join(\" #\"))[0] : null,\r\n\t\t\t\t\t\t\t\t\toldTrigger = valid ? this.select(\"a[href='#\" + oldHashes.slice(0, nth).join(this.delimiter) + \"']\")[0] : null;\r\n\r\n\t\t\t\t\t\t\t\tnewEl = this.select(\"#\" + newHashes.slice(0, nth).join(\" #\"))[0];\r\n\t\t\t\t\t\t\t\tnewTrigger = this.select(\"a[href='#\" + newHashes.slice(0, nth).join(this.delimiter) + \"']\")[0];\r\n\t\t\t\t\t\t\t\tthis.load(oldTrigger || null, oldEl || null, newTrigger || null, newEl || null);\r\n\t\t\t\t\t\t\t}, this);\r\n\r\n\t\t\t\t\t\t\tconst r = new Route({\r\n\t\t\t\t\t\t\t\telement: newEl || null,\r\n\t\t\t\t\t\t\t\thash: newHash,\r\n\t\t\t\t\t\t\t\ttrigger: newTrigger || null\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tthis.log(r);\r\n\t\t\t\t\t\t\tthis.callback(r);\r\n\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\tthis.error(err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tload (oldTrigger, oldEl, newTrigger, newEl) {\r\n\t\t\tif (oldTrigger && this.css.current) {\r\n\t\t\t\toldTrigger.classList.remove(this.css.current);\r\n\t\t\t}\r\n\r\n\t\t\tif (oldEl && oldEl.id !== newEl.id) {\r\n\t\t\t\toldEl.classList.add(this.css.hidden);\r\n\t\t\t}\r\n\r\n\t\t\tif (newTrigger && this.css.current) {\r\n\t\t\t\tnewTrigger.classList.add(this.css.current);\r\n\t\t\t}\r\n\r\n\t\t\tif (newEl) {\r\n\t\t\t\tthis.sweep(newEl, this.css.hidden);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tlog (arg) {\r\n\t\t\tif (this.logging) {\r\n\t\t\t\tthis.history.unshift(arg);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tprocess () {\r\n\t\t\tconst hash = document.location.hash.replace(\"#\", \"\");\r\n\r\n\t\t\tthis.scan(this.start);\r\n\r\n\t\t\tif (!has(this.css.hidden, this.ctx.classList)) {\r\n\t\t\t\tif (hash !== \"\" && includes(this.routes, hash)) {\r\n\t\t\t\t\tthis.hashchange({oldURL: \"\", newURL: document.location.hash});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.route(this.start);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\troute (arg = \"\") {\r\n\t\t\tdocument.location.hash = arg;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tselect (arg) {\r\n\t\t\treturn from(this.ctx.querySelectorAll.call(this.ctx, arg));\r\n\t\t}\r\n\r\n\t\tscan (arg) {\r\n\t\t\tthis.routes = this.select(\"a\").filter(i => includes(i.href, \"#\")).map(i => i.href.replace(not_hash, \"\")).filter(i => i !== \"\");\r\n\t\t\tthis.start = arg || this.routes[0] || null;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tsweep (obj, klass) {\r\n\t\t\tfrom(obj.parentNode.childNodes).filter(i => i.nodeType === 1 && i.id && i.id !== obj.id).forEach(i => i.classList.add(klass));\r\n\t\t\tobj.classList.remove(klass);\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvalid (arg = \"\") {\r\n\t\t\treturn arg === \"\" || (/=/).test(arg) === false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction factory (arg) {\r\n\t\tconst obj = new Router(arg),\r\n\t\t\tfacade = ev => obj.hashchange.call(obj, ev);\r\n\r\n\t\tif (\"addEventListener\" in window) {\r\n\t\t\twindow.addEventListener(\"hashchange\", facade, false);\r\n\t\t} else {\r\n\t\t\twindow.onhashchange = facade;\r\n\t\t}\r\n\r\n\t\tif (obj.active) {\r\n\t\t\tobj.process();\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tfactory.version = \"3.0.7\";\r\n\r\n\t// CJS, AMD & window supported\r\n\tif (typeof exports !== \"undefined\") {\r\n\t\tmodule.exports = factory;\r\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\r\n\t\tdefine(() => factory);\r\n\t} else {\r\n\t\twindow.router = factory;\r\n\t}\r\n}(document, window));\r\n"]}