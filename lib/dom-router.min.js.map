{"version":3,"sources":["dom-router.js"],"names":["location","hash","replace","hashchange","call","addEventListener","onhashchange","scan","start","css","hidden","ctx","classList","routes","oldURL","newURL","route","Array","includes","indexOf","from","slice","Date","getTime","requestAnimationFrame","setTimeout","constructor","element","trigger","timestamp","toISOString","active","callback","current","body","delimiter","logging","stop","history","stopPropagation","preventDefault","split","forEach","length","select","join","load","remove","log","filter","id","add","sweep","unshift","querySelectorAll","href","map","parentNode","childNodes","nodeType","version","exports","define","amd","router","module","document","window"],"mappings":"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","file":"unknown","sourcesContent":["/**\r\n * URL hash DOM router\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2018\r\n * @license BSD-3-Clause\r\n * @version 3.0.0\r\n */\r\n(function (document, window) {\r\n\tconst not_hash = /.*\\#/,\r\n\t\tincludes = typeof Array.includes === \"function\" ? (obj, arg) => obj.includes(arg) : (obj, arg) => obj.indexOf(arg) > -1,\r\n\t\tfrom = typeof Array.from === \"function\" ? arg => Array.from(arg) : arg => [].slice.call(arg),\r\n\t\thas = (a, b) => a in b,\r\n\t\ttime = new Date().getTime(),\r\n\t\trender = window.requestAnimationFrame || function (fn) { setTimeout(fn(new Date().getTime() - time), 16); };\r\n\r\n\tclass Route {\r\n\t\tconstructor (cfg) {\r\n\t\t\tthis.hash = cfg.hash;\r\n\t\t\tthis.element = cfg.element;\r\n\t\t\tthis.trigger = cfg.trigger;\r\n\t\t\tthis.timestamp = new Date().toISOString();\r\n\t\t}\r\n\t}\r\n\r\n\tclass Router {\r\n\t\tconstructor ({active = true, callback = function () {}, css = {current: \"dr-current\", hidden: \"dr-hidden\"}, ctx = document.body, start = null, delimiter = \"/\", logging = false, stop = true} = {}) {\r\n\t\t\tthis.active = active;\r\n\t\t\tthis.callback = callback;\r\n\t\t\tthis.css = css;\r\n\t\t\tthis.ctx = ctx;\r\n\t\t\tthis.start = start;\r\n\t\t\tthis.delimiter = delimiter;\r\n\t\t\tthis.history = [];\r\n\t\t\tthis.logging = logging;\r\n\t\t\tthis.routes = [];\r\n\t\t\tthis.stop = stop;\r\n\t\t}\r\n\r\n\t\tcurrent () {\r\n\t\t\treturn this.history[0];\r\n\t\t}\r\n\r\n\t\thashchange (ev) {\r\n\t\t\tconst self = this,\r\n\t\t\t\toldHash = includes(ev.oldURL, \"#\") ? ev.oldURL.replace(not_hash, \"\") : null,\r\n\t\t\t\tnewHash = includes(ev.newURL, \"#\") ? ev.newURL.replace(not_hash, \"\") : null;\r\n\r\n\t\t\tif (this.active) {\r\n\t\t\t\tif (this.stop === true && typeof ev.stopPropagation === \"function\") {\r\n\t\t\t\t\tev.stopPropagation();\r\n\r\n\t\t\t\t\tif (typeof ev.preventDefault === \"function\") {\r\n\t\t\t\t\t\tev.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!includes(this.routes, newHash)) {\r\n\t\t\t\t\tthis.route(this.routes.filter(i => includes(i, newHash))[0] || this.start);\r\n\t\t\t\t} else {\r\n\t\t\t\t\trender(() => {\r\n\t\t\t\t\t\tlet oldHashes = oldHash ? oldHash.split(self.delimiter) : [];\r\n\t\t\t\t\t\tlet newHashes = newHash.split(self.delimiter);\r\n\t\t\t\t\t\tlet newEl, newTrigger;\r\n\r\n\t\t\t\t\t\tnewHashes.forEach((i, idx) => {\r\n\t\t\t\t\t\t\tlet nth = idx + 1;\r\n\t\t\t\t\t\t\tlet valid = oldHashes.length >= nth;\r\n\t\t\t\t\t\t\tlet oldEl = valid ? self.select(\"#\" + oldHashes.slice(0, nth).join(\" > #\"))[0] : null;\r\n\t\t\t\t\t\t\tlet oldTrigger = valid ? self.select(\"a[href='#\" + oldHashes.slice(0, nth).join(self.delimiter) + \"']\")[0] : null;\r\n\r\n\t\t\t\t\t\t\tnewEl = self.select(\"#\" + newHashes.slice(0, nth).join(\" > #\"))[0];\r\n\t\t\t\t\t\t\tnewTrigger = self.select(\"a[href='#\" + newHashes.slice(0, nth).join(self.delimiter) + \"']\")[0];\r\n\r\n\t\t\t\t\t\t\tself.load(oldTrigger || null, oldEl || null, newTrigger || null, newEl || null);\r\n\t\t\t\t\t\t}, this);\r\n\r\n\t\t\t\t\t\tif (self.css.current && self.history.length > 0) {\r\n\t\t\t\t\t\t\tself.history[0].trigger.classList.remove(self.css.current);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet r = new Route({element: newEl || null, hash: newHash, trigger: newTrigger || null});\r\n\r\n\t\t\t\t\t\tself.log(r);\r\n\t\t\t\t\t\tself.callback(r);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tload (oldTrigger, oldEl, newTrigger, newEl) {\r\n\t\t\tif (oldTrigger && this.css.current) {\r\n\t\t\t\toldTrigger.classList.remove(this.css.current);\r\n\t\t\t}\r\n\r\n\t\t\tif (oldEl && oldEl.id !== newEl.id) {\r\n\t\t\t\toldEl.classList.add(this.css.hidden);\r\n\t\t\t}\r\n\r\n\t\t\tif (newTrigger && this.css.current) {\r\n\t\t\t\tnewTrigger.classList.add(this.css.current);\r\n\t\t\t}\r\n\r\n\t\t\tif (newEl) {\r\n\t\t\t\tthis.sweep(newEl, this.css.hidden);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tlog (arg) {\r\n\t\t\tif (this.logging) {\r\n\t\t\t\tthis.history.unshift(arg);\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\troute (arg = \"\") {\r\n\t\t\tdocument.location.hash = arg;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tselect (arg) {\r\n\t\t\treturn from(this.ctx.querySelectorAll.call(this.ctx, arg));\r\n\t\t}\r\n\r\n\t\tscan (arg) {\r\n\t\t\tthis.routes = this.select(\"a\").filter(i => includes(i.href, \"#\")).map(i => i.href.replace(not_hash, \"\"));\r\n\t\t\tthis.start = arg || this.routes[0] || null;\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tsweep (obj, klass) {\r\n\t\t\tfrom(obj.parentNode.childNodes).filter(i => i.nodeType === 1 && i.id && i.id !== obj.id).forEach(i => i.classList.add(klass));\r\n\t\t\tobj.classList.remove(klass);\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction factory (arg) {\r\n\t\tconst obj = new Router(arg),\r\n\t\t\thash = document.location.hash.replace(\"#\", \"\"),\r\n\t\t\tfacade = ev => obj.hashchange.call(obj, ev);\r\n\r\n\t\tif (\"addEventListener\" in window) {\r\n\t\t\twindow.addEventListener(\"hashchange\", facade, false);\r\n\t\t} else {\r\n\t\t\twindow.onhashchange = facade;\r\n\t\t}\r\n\r\n\t\tobj.scan(obj.start);\r\n\r\n\t\tif (!has(obj.css.hidden, obj.ctx.classList)) {\r\n\t\t\tif (hash !== \"\" && includes(obj.routes, hash)) {\r\n\t\t\t\tobj.hashchange({oldURL: \"\", newURL: document.location.hash});\r\n\t\t\t} else {\r\n\t\t\t\tobj.route(obj.start);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tfactory.version = \"3.0.0\";\r\n\r\n\t// CJS, AMD & window supported\r\n\tif (typeof exports !== \"undefined\") {\r\n\t\tmodule.exports = factory;\r\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\r\n\t\tdefine(() => factory);\r\n\t} else {\r\n\t\twindow.router = factory;\r\n\t}\r\n}(document, window));\r\n"]}