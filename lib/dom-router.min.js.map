{"version":3,"sources":["dom-router.js"],"names":["document","window","factory","arg","obj","Router","hashchange","bind","addEventListener","onhashchange","active","process","not_hash","includes","Array","indexOf","from","slice","call","has","a","b","time","Date","getTime","render","requestAnimationFrame","fn","setTimeout","Route","constructor","cfg","hash","element","trigger","timestamp","toISOString","callback","css","current","hidden","ctx","body","start","delimiter","error","logging","stop","history","routes","ev","oldHash","oldURL","replace","newHash","newURL","valid","stopPropagation","preventDefault","oldHashes","split","newHashes","newEl","newTrigger","forEach","i","idx","nth","length","oldEl","select","join","oldTrigger","load","r","log","err","route","filter","classList","remove","id","add","sweep","unshift","location","scan","querySelectorAll","Set","href","map","klass","parentNode","childNodes","nodeType","test","version","exports","define","amd","router","module"],"mappings":"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","file":"unknown","sourcesContent":["/**\n * URL hash DOM router\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2019\n * @license BSD-3-Clause\n * @version 3.1.3\n */\n\n\"use strict\";\n\n(function (document, window) {\n\tconst not_hash = /.*\\#/,\n\t\tincludes = typeof Array.includes === \"function\" ? (obj, arg) => obj.includes(arg) : (obj, arg) => obj.indexOf(arg) > -1,\n\t\tfrom = typeof Array.from === \"function\" ? arg => Array.from(arg) : arg => [].slice.call(arg),\n\t\thas = (a, b) => a in b,\n\t\ttime = new Date().getTime(),\n\t\trender = window.requestAnimationFrame || function (fn) { setTimeout(fn(new Date().getTime() - time), 16); };\n\n\tclass Route {\n\t\tconstructor (cfg) {\n\t\t\tthis.hash = cfg.hash;\n\t\t\tthis.element = cfg.element;\n\t\t\tthis.trigger = cfg.trigger;\n\t\t\tthis.timestamp = new Date().toISOString();\n\t\t}\n\t}\n\n\tclass Router {\n\t\tconstructor ({active = true, callback = function () {}, css = {current: \"dr-current\", hidden: \"dr-hidden\"}, ctx = document.body, start = null, delimiter = \"/\", error = function () {}, logging = false, stop = true} = {}) {\n\t\t\tthis.active = active;\n\t\t\tthis.callback = callback;\n\t\t\tthis.css = css;\n\t\t\tthis.ctx = ctx;\n\t\t\tthis.error = error;\n\t\t\tthis.start = start;\n\t\t\tthis.delimiter = delimiter;\n\t\t\tthis.history = [];\n\t\t\tthis.logging = logging;\n\t\t\tthis.routes = [];\n\t\t\tthis.stop = stop;\n\t\t}\n\n\t\tcurrent () {\n\t\t\treturn this.history[0];\n\t\t}\n\n\t\thashchange (ev) {\n\t\t\tconst oldHash = includes(ev.oldURL, \"#\") ? ev.oldURL.replace(not_hash, \"\") : null,\n\t\t\t\tnewHash = includes(ev.newURL, \"#\") ? ev.newURL.replace(not_hash, \"\") : null;\n\n\t\t\tif (this.active && this.valid(newHash)) {\n\t\t\t\tif (this.stop === true && typeof ev.stopPropagation === \"function\") {\n\t\t\t\t\tev.stopPropagation();\n\n\t\t\t\t\tif (typeof ev.preventDefault === \"function\") {\n\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!includes(this.routes, newHash)) {\n\t\t\t\t\tthis.route(this.routes.filter(i => includes(i, newHash))[0] || this.start);\n\t\t\t\t} else {\n\t\t\t\t\trender(() => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst oldHashes = oldHash ? oldHash.split(this.delimiter) : [],\n\t\t\t\t\t\t\t\tnewHashes = newHash.split(this.delimiter);\n\t\t\t\t\t\t\tlet newEl, newTrigger;\n\n\t\t\t\t\t\t\tnewHashes.forEach((i, idx) => {\n\t\t\t\t\t\t\t\tconst nth = idx + 1,\n\t\t\t\t\t\t\t\t\tvalid = oldHashes.length >= nth,\n\t\t\t\t\t\t\t\t\toldEl = valid ? this.select(`#${oldHashes.slice(0, nth).join(\" #\")}`) : void 0,\n\t\t\t\t\t\t\t\t\toldTrigger = valid ? this.select(`a[href='#${oldHashes.slice(0, nth).join(this.delimiter)}']`) : void 0;\n\n\t\t\t\t\t\t\t\tnewEl = this.select(`#${newHashes.slice(0, nth).join(\" #\")}`);\n\t\t\t\t\t\t\t\tnewTrigger = this.select(`a[href='#${newHashes.slice(0, nth).join(this.delimiter)}']`);\n\t\t\t\t\t\t\t\tthis.load(oldTrigger, oldEl, newTrigger, newEl);\n\t\t\t\t\t\t\t}, this);\n\n\t\t\t\t\t\t\tconst r = new Route({\n\t\t\t\t\t\t\t\telement: newEl,\n\t\t\t\t\t\t\t\thash: newHash,\n\t\t\t\t\t\t\t\ttrigger: newTrigger\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.log(r);\n\t\t\t\t\t\t\tthis.callback(r);\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tthis.error(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tload (oldTrigger = [], oldEl = [], newTrigger = [], newEl = []) {\n\t\t\tif (this.css.current.length > 0) {\n\t\t\t\tif (oldTrigger.length > 0) {\n\t\t\t\t\toldTrigger.forEach(i => i.classList.remove(this.css.current));\n\t\t\t\t}\n\n\t\t\t\tif (oldEl.length > 0 && oldEl.id !== newEl.id) {\n\t\t\t\t\toldEl.forEach(i => i.classList.add(this.css.hidden));\n\t\t\t\t}\n\n\t\t\t\tif (newTrigger.length > 0) {\n\t\t\t\t\tnewTrigger.forEach(i => i.classList.add(this.css.current));\n\t\t\t\t}\n\n\t\t\t\tif (newEl.length > 0) {\n\t\t\t\t\tnewEl.forEach(i => this.sweep(i, this.css.hidden));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlog (arg) {\n\t\t\tif (this.logging) {\n\t\t\t\tthis.history.unshift(arg);\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\n\t\tprocess () {\n\t\t\tconst hash = document.location.hash.replace(\"#\", \"\");\n\n\t\t\tthis.scan(this.start);\n\n\t\t\tif (!has(this.css.hidden, this.ctx.classList)) {\n\t\t\t\tif (hash.length > 0 && includes(this.routes, hash)) {\n\t\t\t\t\tthis.hashchange({oldURL: \"\", newURL: document.location.hash});\n\t\t\t\t} else {\n\t\t\t\t\tthis.route(this.start);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\troute (arg = \"\") {\n\t\t\tdocument.location.hash = arg;\n\n\t\t\treturn this;\n\t\t}\n\n\t\tselect (arg) {\n\t\t\treturn from(this.ctx.querySelectorAll.call(this.ctx, arg));\n\t\t}\n\n\t\tscan (arg) {\n\t\t\tthis.routes = Array.from(new Set(this.select(\"a\").filter(i => includes(i.href, \"#\")).map(i => i.href.replace(not_hash, \"\")).filter(i => i !== \"\")));\n\t\t\tthis.start = arg || this.routes[0] || null;\n\n\t\t\treturn this;\n\t\t}\n\n\t\tsweep (obj, klass) {\n\t\t\tfrom(obj.parentNode.childNodes).filter(i => i.nodeType === 1 && i.id && i.id !== obj.id).forEach(i => i.classList.add(klass));\n\t\t\tobj.classList.remove(klass);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tvalid (arg = \"\") {\n\t\t\treturn arg === \"\" || (/=/).test(arg) === false;\n\t\t}\n\t}\n\n\tfunction factory (arg) {\n\t\tconst obj = new Router(arg);\n\n\t\tobj.hashchange = obj.hashchange.bind(obj);\n\n\t\tif (\"addEventListener\" in window) {\n\t\t\twindow.addEventListener(\"hashchange\", obj.hashchange, false);\n\t\t} else {\n\t\t\twindow.onhashchange = obj.hashchange;\n\t\t}\n\n\t\tif (obj.active) {\n\t\t\tobj.process();\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\tfactory.version = \"3.1.3\";\n\n\t// CJS, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\n\t\tdefine(() => factory);\n\t} else {\n\t\twindow.router = factory;\n\t}\n}(document, window));\n"]}