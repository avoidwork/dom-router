{"version":3,"file":"dom-router.min.js","sources":["dom-router.js"],"names":["document","window","contains","obj","arg","indexOf","Route","this","hash","element","route","Router","active","callback","css","hidden","ctx","history","log","routes","selector","stop","router","r","location","replace","addEventListener","hashchange","undefined","$","filter","a","href","map","not_hash","classList","hasClass","remove","add","render","querySelectorAll","bind","time","Date","getTime","requestAnimationFrame","fn","offset","setTimeout","prototype","constructor","current","ev","$oldEl","$newEl","$oldItem","$newItem","oldHash","oldURL","newHash","newURL","preventDefault","stopPropagation","parentNode","unshift","exports","module","define"],"mappings":";;;;CAUA,SAAaA,EAAUC,GACvB,YAuBA,SAASC,GAAWC,EAAKC,GACxB,MAAOD,GAAIE,QAASD,GAAQ,GAG7B,QAASE,GAAQF,GAChBG,KAAKC,KAAOJ,EAAII,KAChBD,KAAKE,QAAUL,EAAIK,QAGpB,QAASC,GAAQN,GAChB,MAAO,IAAIE,GAAOF,GAQnB,QAASO,UACRJ,KAAKK,OAAS,KACdL,KAAKM,SAAW,KAChBN,KAAKO,KAAOF,OAAQ,SAAUG,OAAQ,UACtCR,KAAKS,IAAM,KACXT,KAAK,WAAa,KAClBA,KAAKU,WACLV,KAAKW,KAAM,EACXX,KAAKY,UACLZ,KAAKa,SAAW,KAChBb,KAAKc,MAAO,EAwFb,QAASC,GAASlB,GACjB,GAAImB,GAAI,GAAIZ,QACXH,EAAOR,EAASwB,SAAShB,KAAKiB,QAAS,IAAK,GAuC7C,OApCAxB,GAAOyB,iBAAkB,aAAcH,EAAEI,YAAY,GAGrDJ,EAAEX,OAAwBgB,SAAfxB,EAAIQ,OAAyBR,EAAIQ,UAAW,GAAS,EAChEW,EAAEV,SAAWT,EAAIS,UAAY,KAC7BU,EAAEP,IAAMZ,EAAIY,KAAOa,EAAE,QAAQ,GAC7BN,EAAEL,IAAkBU,SAAZxB,EAAIc,IAAsBd,EAAIc,OAAQ,GAAS,EACvDK,EAAEH,SAAWhB,EAAIgB,UAAY,KAC7BG,EAAEF,KAAoBO,SAAbxB,EAAIiB,KAAuBjB,EAAIiB,QAAS,GAAS,EAErDjB,EAAIU,MACRS,EAAET,KAAQF,OAAQ,SAAUG,OAAQ,WAGrCQ,EAAEJ,OAASU,EAAGN,EAAEP,IAAM,MAAOc,OAAQ,SAAWC,GAC/C,MAAO7B,GAAU6B,EAAEC,KAAM,OACtBC,IAAK,SAAWF,GACnB,MAAOA,GAAEC,KAAKP,QAASS,EAAU,MAGlCX,EAAE,WAAanB,EAAI,YAAcmB,EAAEJ,OAAO,GAGpCI,EAAEP,IAAImB,UAAUC,SAAUb,EAAET,IAAIC,UACvB,KAATP,GAAeN,EAAUqB,EAAEJ,OAAQX,IACvCqB,EAAGN,EAAEP,IAAM,KAAOR,GAAO,GAAG2B,UAAUE,OAAQd,EAAET,IAAIC,QAE/CQ,EAAET,IAAIF,QACViB,EAAGN,EAAEP,IAAM,aAAeR,EAAO,MAAQ,GAAI2B,UAAUG,IAAKf,EAAET,IAAIF,SAInEW,EAAEb,MAAOa,EAAE,aAINA,EAlLR,GAGCgB,GAHGV,EAAI7B,EAASwC,iBAAiBC,KAAMzC,GACvCkC,EAAW,OACXQ,GAAO,GAAIC,OAAOC,SAGnBL,GAAStC,EAAO4C,uBAAyB,SAAWC,GACnD,GAAIC,IAAS,GAAIJ,OAAOC,UAAYF,CAEpCM,YAAY,WACXF,EAAIC,IACF,KA+CJpC,OAAOsC,UAAUC,YAAcvC,OAQ/BA,OAAOsC,UAAUE,QAAU,WAC1B,MAAO5C,MAAKU,QAAQ,IAUrBN,OAAOsC,UAAUtB,WAAa,SAAWyB,GACxC,GAECC,GAAQC,EAAQC,EAAUC,EAAUjC,EAFjCkC,EAAUvD,EAAUkD,EAAGM,OAAQ,KAAQN,EAAGM,OAAOjC,QAASS,EAAU,IAAO,KAC9EyB,EAAUzD,EAAUkD,EAAGQ,OAAQ,KAAQR,EAAGQ,OAAOnC,QAASS,EAAU,IAAO,MAGrEuB,EAAUvD,EAAUK,KAAKY,OAAQsC,IAAY,KAAYE,EAAUzD,EAAUK,KAAKY,OAAQwC,IAAY,KAC5GN,EAASI,EAAU5B,EAAGtB,KAAKS,IAAM,KAAOyC,GAAW,GAAM,KACzDH,EAASK,EAAU9B,EAAGtB,KAAKS,IAAM,KAAO2C,GAAW,GAAM,KACzDJ,EAAWE,EAAU5B,EAAGtB,KAAKS,IAAM,aAAeyC,EAAU,MAAQ,GAAM,KAC1ED,EAAWG,EAAU9B,EAAGtB,KAAKS,IAAM,aAAe2C,EAAU,MAAQ,GAAM,KAC1EpC,EAAIb,GAASD,QAAS6C,EAAQ9C,KAAMmD,IAE/BpD,KAAKc,QAAS,IAClB+B,EAAGS,iBACHT,EAAGU,mBAGJvB,EAAQ,WACFgB,GAAYF,IAChBE,EAASQ,WAAW5B,UAAUE,OAAQ9B,KAAKO,IAAIF,QAC/CyC,EAAOlB,UAAUG,IAAK/B,KAAKO,IAAIC,SAG3ByC,GAAYF,GAChBE,EAASO,WAAW5B,UAAUG,IAAK/B,KAAKO,IAAIF,QAC5C0C,EAAOnB,UAAUE,OAAQ9B,KAAKO,IAAIC,SAEzBR,KAAM,YACfA,KAAKG,MAAOH,KAAK,YAGbA,KAAKW,OAAQ,GACjBX,KAAKU,QAAQ+C,QAASzC,GAGA,OAAlBhB,KAAKM,UACTN,KAAKM,SAAUU,OAcnBZ,OAAOsC,UAAUvC,MAAQ,SAAWN,GAEnC,MADAJ,GAASwB,SAAShB,KAAOJ,EAClBG,MAsDe,mBAAX0D,SACXC,OAAOD,QAAU3C,EAES,kBAAV6C,QAChBA,OAAQ,WACP,MAAO7C,KAIRrB,EAAOqB,OAASA,GAEZtB,SAAUC","sourcesContent":["/**\n * URL hash to DOM router\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2014 Jason Mulligan\n * @license BSD-3 <https://raw.github.com/avoidwork/dom-router/master/LICENSE>\n * @link http://avoidwork.github.io/dom-router\n * @module dom-router\n * @version 1.0.0\n */\n( function ( document, window ) {\n\"use strict\";\n\nvar $ = document.querySelectorAll.bind( document ),\n\tnot_hash = /.*\\#/,\n\ttime = new Date().getTime(),\n\trender;\n\nrender = window.requestAnimationFrame || function ( fn ) {\n\tvar offset = new Date().getTime() - time;\n\n\tsetTimeout( function () {\n\t\tfn( offset );\n\t}, 16 );\n};\n\n/**\n * Determines if `arg` is in `obj`\n *\n * @method contains\n * @param  {Mixed} obj Object to inspect\n * @param  {Mixed} arg Value to find\n * @return {Boolean}   `true` if found\n */\nfunction contains ( obj, arg ) {\n\treturn obj.indexOf( arg ) > -1;\n}\n\nfunction Route ( arg ) {\n\tthis.hash = arg.hash;\n\tthis.element = arg.element;\n}\n\nfunction route ( arg ) {\n\treturn new Route( arg );\n}\n\n/**\n * URL hash to DOM router\n *\n * @constructor\n */\nfunction Router () {\n\tthis.active = null;\n\tthis.callback = null;\n\tthis.css = {active: \"active\", hidden: \"hidden\"};\n\tthis.ctx = null;\n\tthis[\"default\"] = null;\n\tthis.history = [];\n\tthis.log = false;\n\tthis.routes = [];\n\tthis.selector = null;\n\tthis.stop = true;\n}\n\n/**\n * Setting constructor loop\n *\n * @type {Object}\n */\nRouter.prototype.constructor = Router;\n\n/**\n * Returns the current route descriptor\n *\n * @method current\n * @return {Object} Route descriptor\n */\nRouter.prototype.current = function () {\n\treturn this.history[0];\n};\n\n/**\n * Hash change handler\n *\n * @method hashchange\n * @param  {Object} Event\n * @return {Undefined} undefined\n */\nRouter.prototype.hashchange = function ( ev ) {\n\tvar oldHash = contains( ev.oldURL, \"#\" ) ? ev.oldURL.replace( not_hash, \"\" ) : null,\n\t\tnewHash = contains( ev.newURL, \"#\" ) ? ev.newURL.replace( not_hash, \"\" ) : null,\n\t\t$oldEl, $newEl, $oldItem, $newItem, r;\n\n\tif ( ( oldHash ? contains( this.routes, oldHash ) : true ) && ( newHash ? contains( this.routes, newHash ) : false ) ) {\n\t\t$oldEl = oldHash ? $( this.ctx + \" #\" + oldHash )[ 0 ] : null;\n\t\t$newEl = newHash ? $( this.ctx + \" #\" + newHash )[ 0 ] : null;\n\t\t$oldItem = oldHash ? $( this.ctx + \" a[href='#\" + oldHash + \"']\" )[ 0 ] : null;\n\t\t$newItem = newHash ? $( this.ctx + \" a[href='#\" + newHash + \"']\" )[ 0 ] : null;\n\t\tr = route( { element: $newEl, hash: newHash } );\n\n\t\tif ( this.stop === true ) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t}\n\n\t\trender( function () {\n\t\t\tif ( $oldItem && $oldEl ) {\n\t\t\t\t$oldItem.parentNode.classList.remove( this.css.active );\n\t\t\t\t$oldEl.classList.add( this.css.hidden );\n\t\t\t}\n\n\t\t\tif ( $newItem && $newEl ) {\n\t\t\t\t$newItem.parentNode.classList.add( this.css.active );\n\t\t\t\t$newEl.classList.remove( this.css.hidden );\n\t\t\t}\n\t\t\telse if ( this[ \"default\" ] ) {\n\t\t\t\tthis.route( this[\"default\"] );\n\t\t\t}\n\n\t\t\tif ( this.log === true ) {\n\t\t\t\tthis.history.unshift( r );\n\t\t\t}\n\n\t\t\tif ( this.callback !== null ) {\n\t\t\t\tthis.callback( r );\n\t\t\t}\n\t\t} );\n\t}\n};\n\n/**\n * Sets the route\n *\n * @method route\n * @param  {String} arg Route to set\n * @return {Object} Router\n * @todo make this smarter, such that it can be nested within another router automatically\n */\nRouter.prototype.route = function ( arg ) {\n\tdocument.location.hash = arg;\n\treturn this;\n};\n\n/**\n * Router factory\n *\n * @param  {Object} arg Descriptor\n * @return {Object} Router\n */\nfunction router ( arg ) {\n\tvar r = new Router(),\n\t\thash = document.location.hash.replace( \"#\", \"\" );\n\n\t// Adding hook\n\twindow.addEventListener( \"hashchange\", r.hashchange, false );\n\n\t// Setting properties\n\tr.active = arg.active !== undefined ? ( arg.active === true ) : true;\n\tr.callback = arg.callback || null;\n\tr.ctx = arg.ctx || $(\"body\")[0];\n\tr.log = arg.log !== undefined ? ( arg.log === true ) : false;\n\tr.selector = arg.selector || null; // forgot what this was for :(\n\tr.stop = arg.stop !== undefined ? ( arg.stop === true ) : true;\n\n\tif ( arg.css ) {\n\t\tr.css = { active: \"active\", hidden: \"hidden\" };\n\t}\n\n\tr.routes = $( r.ctx + \" a\" ).filter( function ( a ) {\n\t\treturn contains( a.href, \"#\" );\n\t} ).map( function ( a ) {\n\t\treturn a.href.replace( not_hash, \"\" );\n\t} );\n\n\tr[\"default\"] = arg[\"default\"] || r.routes[0];\n\n\t// Setting state\n\tif ( !r.ctx.classList.hasClass( r.css.hidden ) ) {\n\t\tif ( hash !== \"\" && contains( r.routes, hash ) ) {\n\t\t\t$( r.ctx + \" #\" + hash )[0].classList.remove( r.css.hidden );\n\n\t\t\tif ( r.css.active ) {\n\t\t\t\t$( r.ctx + \" a[href='#\" + hash + \"']\" )[ 0 ].classList.add( r.css.active );\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tr.route( r[\"default\"] );\n\t\t}\n\t}\n\n\treturn r;\n}\n\n// CJS, AMD & window supported\nif ( typeof exports != \"undefined\" ) {\n\tmodule.exports = router;\n}\nelse if ( typeof define == \"function\" ) {\n\tdefine( function () {\n\t\treturn router;\n\t} );\n}\nelse {\n\twindow.router = router;\n}\n} )( document, window );\n"]}